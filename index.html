<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Silver Star</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="lib/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="src/main.css">
    <link rel="stylesheet" type="text/css" href="src/galaxy.css">
  </head>
  <body>
    <div id="spinner" class="lds-dual-ring"></div>
    <div id="ui-main" align="center">
      <!--MENU---------------------------------------------->
      <div class="d-flex flex-row m-1" style="z-index:100;position:fixed;">
        <div>
          <a class="btn btn-info btn-sm" data-toggle="collapse" href="#menu-list" role="button">
            <img src="media/md-menu.svg" height="20" width="20">
          </a>
        </div>
        <div>
          <div class="card collapse" id="menu-list" style="width:200px;">
            <div class="card card-body p-1">
              <button type="button" class="mt-3 btn btn-block btn-danger" @click="reset()" data-toggle="collapse" href="#menu-list">Reset</button>
            </div>
          </div>
        </div>
      </div>
      <!--END MENU---------------------------------------------->
      <!--OVERHEAD---------------------------------------------->
      <div class="overlay p-1 border" style="top:0;">
        <div class="d-flex justify-content-around">
          <div class="btn-group" role="group" v-for="F in factions" v-if="fid==F.id && F.name" v-cloak>
            <button type="button" class="btn btn-light font-weight-bold">{{F.name}} ({{stats.b.join('/')}})</button>
            <div class="btn-group" role="group">
              <button type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown"></button>
              <div class="dropdown-menu">
                <a class="dropdown-item" href="#" v-for="f in factions" v-if="f.id != 0" @click="fid=f.id">{{f.name}}</a>
              </div>
            </div>
          </div>
        </div>
        <div v-if="sector" align="left" v-cloak>
          <h4 class="mx-1 mb-1 d-flex justify-content-between align-items-center">
            <span>Sector {{sector.i}}</span>
            <div class="dropdown">
              <button class="btn btn-secondary dropdown-toggle" type="button" data-toggle="dropdown">Owner: {{sector.owner.name}}</button>
              <div class="dropdown-menu">
                <a class="dropdown-item" href="#" @click="setOwner(f.id)" v-for="f in factions">{{f.name}}</a>
              </div>
            </div>
          </h4>
          <div class="mx-2">
            <div class="input-group" v-if="sector.mayBuild">
              <select class="custom-select" v-model="toBuild">
                <option v-for="b in allBuild" :value="b.d">{{b.text}}</option>
              </select>
              <div class="input-group-append">
                <button class="btn btn-success" type="button" @click="build()">Build</button>
              </div>
            </div>
            <div v-if="sector.trouble">
              <strong>Trouble: </strong>
              <span>{{sector.trouble.text}} ({{sector.trouble.save}}) - Level {{sector.trouble.lv}}</span>
            </div>
            <div v-if="sector.colony">
              <div>
                <strong>Colony (R{{sector.colony.r}}): </strong>
                <span>{{sector.colony.text}}</span>
              </div>
            </div>
            <div v-if="sector.assets.length>0" class="d-flex align-items-center flex-wrap">
              <strong>Assets: </strong>
              <div v-for="(a,i) in sector.assets" class="d-flex">
                <div class="btn-group btn-group-sm" role="group">
                  <button type="button" class="btn btn-light">{{a.name}}</button>
                  <div class="btn-group btn-group-sm" role="group" v-if="a.act" v-cloak>
                    <button type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown"></button>
                    <div class="dropdown-menu">
                      <a class="dropdown-item" href="#" v-for="act in a.act" @click="action(i,act)">{{act}}</a>
                    </div>
                  </div>
                  <button type="button" class="btn btn-warning" @click="sector._assets.splice(i,1),reDrawUnits()">&#10008;</button>
                </div>
                <div class="input-group" v-if="toMove[0]==i">
                  <select class="custom-select" v-model="toMove[1]">
                    <option v-for="n in sector.neighbors" :value="n">{{n}}</option>
                  </select>
                  <div class="input-group-append">
                    <button class="btn btn-outline-success" type="button" @click="move()">Go</button>
                  </div>
                </div>
              </div>
            </div>
            <div v-if="sector.inWork.length>0">
              <div>
                <strong>In Work: </strong>
                <div class="btn-group btn-group-sm" role="group" v-for="(iw,i) in sector.inWork">
                  <button type="button" class="btn btn-light">{{iw}}</button>
                  <button type="button" class="btn btn-success" @click="work(i)">work</button>
                </div>
              </div>
            </div>
            <div v-if="sector.ruin">
              <strong>Ruin: </strong>
              <span>{{sector.ruin.text}}</span>
            </div>
            <div v-if="sector.lair" class="d-flex justify-content-between align-items-center">
              <div><strong>Lair: </strong>
              <span>{{sector.lair.name}}</span>
              </div>
              <button type="button" class="btn btn-warning" @click="lairCheck()">Lair Check</button>
            </div>
            <div v-if="sector.resource">
              <strong>Resource: </strong>
              <span>{{sector.resource.text}}</span>
            </div>
          </div>
          <div class="m-2" v-if="R[0]>0" align="center">
            <div class="btn-group" role="group">
              <button type="button" class="btn" :class="[R[1] ? 'btn-success' : 'btn-warning']">Roll {{R[0]}}</button>
              <button type="button" class="btn btn-secondary" @click="R=[0,false]">&#10008;</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="map">
      <svg>
        <defs>
          <clipPath id="clip-circle">
            <circle cx="400" cy="400" r="400"/>
          </clipPath>
        </defs>
      </svg>
    </div>
  </body>
  <script src="lib/ethers-v4.min.js"></script>
  <script src="lib/d3.v5.min.js"></script>
  <script src="lib/d3-delaunay.min.js"></script>
  <script src="lib/vue.2.5.16.min.js"></script>
  <script src="lib/jquery-3.3.1.min.js"></script>
  <script src="lib/popper.1.12.3.min.js"></script>
  <script src="lib/bootstrap.min.js"></script>
  <script type="module" src="src/main.js"></script>
</html>
